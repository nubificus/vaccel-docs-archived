
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.8">
    
    
      
        <title>vAccel API (WiP) - vAccel</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vaccel-api-wip" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="vAccel" class="md-header-nav__button md-logo" aria-label="vAccel">
      
  <img src="../img/vaccel-logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            vAccel
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              vAccel API (WiP)
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="vAccel" class="md-nav__button md-logo" aria-label="vAccel">
      
  <img src="../img/vaccel-logo.png" alt="logo">

    </a>
    vAccel
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        Quickstart
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        User Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../vaccelrt/" class="md-nav__link">
        Building the vAccel Runtime
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" >
      
      <label class="md-nav__link" for="nav-3-2">
        Plugins
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Plugins" data-md-level="2">
        <label class="md-nav__title" for="nav-3-2">
          <span class="md-nav__icon md-icon"></span>
          Plugins
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../jetson/" class="md-nav__link">
        Jetson-inference
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../virtio/" class="md-nav__link">
        Virtio Accel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../coral/" class="md-nav__link">
        Google Coral TPU
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../run/" class="md-nav__link">
        Running a simple example
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../kata-vaccel/" class="md-nav__link">
        vAccel on kata containers
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
      
      <label class="md-nav__link" for="nav-5">
        k8s
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="k8s" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          k8s
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../devmapper/" class="md-nav__link">
        Devmapper
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../k8s/kata/" class="md-nav__link">
        vAccel on k8s using Kata-containers & Firecracker
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
      
      <label class="md-nav__link" for="nav-6">
        Unikernels
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Unikernels" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          Unikernels
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../unikernels/unikraft/" class="md-nav__link">
        How to run a vAccel application using Unikraft
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usecases/" class="md-nav__link">
        Use Cases
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
      
      <label class="md-nav__link" for="nav-9">
        Developer Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developer Guide" data-md-level="1">
        <label class="md-nav__title" for="nav-9">
          <span class="md-nav__icon md-icon"></span>
          Developer Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          vAccel API (WiP)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        vAccel API (WiP)
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#image-inference" class="md-nav__link">
    Image inference
  </a>
  
    <nav class="md-nav" aria-label="Image inference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#image-classification" class="md-nav__link">
    Image classification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-segmentation" class="md-nav__link">
    Image segmentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-detection" class="md-nav__link">
    Object detection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blas-library-functions" class="md-nav__link">
    BLAS library functions
  </a>
  
    <nav class="md-nav" aria-label="BLAS library functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matrix-to-matrix-multiplication" class="md-nav__link">
    Matrix-to-matrix multiplication
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-executor" class="md-nav__link">
    Generic executor
  </a>
  
    <nav class="md-nav" aria-label="Generic executor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exec" class="md-nav__link">
    Exec
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../plugin/" class="md-nav__link">
        Add a plugin
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#image-inference" class="md-nav__link">
    Image inference
  </a>
  
    <nav class="md-nav" aria-label="Image inference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#image-classification" class="md-nav__link">
    Image classification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-segmentation" class="md-nav__link">
    Image segmentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-detection" class="md-nav__link">
    Object detection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blas-library-functions" class="md-nav__link">
    BLAS library functions
  </a>
  
    <nav class="md-nav" aria-label="BLAS library functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matrix-to-matrix-multiplication" class="md-nav__link">
    Matrix-to-matrix multiplication
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-executor" class="md-nav__link">
    Generic executor
  </a>
  
    <nav class="md-nav" aria-label="Generic executor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exec" class="md-nav__link">
    Exec
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="vaccel-api-wip">vAccel API (WiP)</h1>
<p>The vAccel API is work in progress. This page presents the current form of the
vAccel frontend API, that is what is presented to the user. Using this API
users can build vAccel applications that interface directly with libvaccel.so
and their operations can be executed using vAccel plugins.</p>
<h2 id="image-inference">Image inference</h2>
<p>vAccel supports a set of operations for Image inference using the following
primitive functions (per operation):</p>
<h4 id="image-classification">Image classification</h4>
<pre><code class="language-C">int vaccel_image_classification(struct vaccel_session *sess, const void *img,
        unsigned char *out_text, unsigned char *out_imgname,
        size_t len_img, size_t len_out_text, size_t len_out_imgname);
</code></pre>
<ul>
<li><code>struct vaccel_session *sess</code>: a pointer to a vAccel session created using
  <code>vaccel_sess_init()</code>;</li>
<li><code>const void *img</code>: the buffer holding the data to the input image.</li>
<li><code>unsigned char *out_text</code>: the buffer holding the classification tag output</li>
<li><code>unsigned char *out_imgname</code>: the name of the processed image, created as a
session resource (EXPERIMENTAL).</li>
<li><code>size_t len_img</code>: the size of <code>img</code> in bytes.</li>
<li><code>size_t len_out_text</code>: the size of <code>out_text</code> in bytes.</li>
<li><code>size_t len_out_imgname</code>: the size of <code>out_imagename</code> in bytes.</li>
</ul>
<h4 id="image-segmentation">Image segmentation</h4>
<pre><code class="language-C">int vaccel_image_segmentation(struct vaccel_session *sess, const void *img,
        const unsigned char *out_imgname, size_t len_img,
        size_t len_out_imgname);
</code></pre>
<ul>
<li><code>struct vaccel_session *sess</code>: a pointer to a vAccel session created using
  <code>vaccel_sess_init()</code>;</li>
<li><code>const void *img</code>: the buffer holding the data to the input image.</li>
<li><code>unsigned char *out_imgname</code>: the name of the processed image, created as a
session resource (EXPERIMENTAL).</li>
<li><code>size_t len_img</code>: the size of <code>img</code> in bytes.</li>
<li><code>size_t len_out_imgname</code>: the size of <code>out_imagename</code> in bytes.</li>
</ul>
<h4 id="object-detection">Object detection</h4>
<pre><code class="language-C">int vaccel_image_detection(struct vaccel_session *sess, const void *img,
        const unsigned char *out_imgname, size_t len_img,
        size_t len_out_imgname);
</code></pre>
<ul>
<li><code>struct vaccel_session *sess</code>: a pointer to a vAccel session created using
  <code>vaccel_sess_init()</code>;</li>
<li><code>const void *img</code>: the buffer holding the data to the input image.</li>
<li><code>unsigned char *out_imgname</code>: the name of the processed image, created as a
session resource (EXPERIMENTAL).</li>
<li><code>size_t len_img</code>: the size of <code>img</code> in bytes.</li>
<li><code>size_t len_out_imgname</code>: the size of <code>out_imagename</code> in bytes.</li>
</ul>
<h2 id="blas-library-functions">BLAS library functions</h2>
<h4 id="matrix-to-matrix-multiplication">Matrix-to-matrix multiplication</h4>
<pre><code class="language-C">int vaccel_sgemm(struct vaccel_session *sess, uint32_t k, uint32_t m,
        uint32_t n, size_t len_a, size_t len_b, size_t len_c,
        float *a, float *b, float *c);
</code></pre>
<ul>
<li><code>struct vaccel_session *sess</code>: a pointer to a vAccel session created using
  <code>vaccel_sess_init()</code>.</li>
<li><code>uint32_t k</code>: first dimension of matrix A &amp; matrix C.</li>
<li><code>uint32_t l</code>: second dimension of matrix A &amp; first dimension of matrix B.</li>
<li><code>uint32_t n</code>: second dimension of matrix B &amp; matrix C.</li>
<li><code>size_t len_a</code>: size of matrix A in bytes.</li>
<li><code>size_t len_b</code>: size of matrix B in bytes.</li>
<li><code>size_t len_c</code>: size of matrix C in bytes.</li>
<li><code>float *a</code>: pointer to matrix A.</li>
<li><code>float *b</code>: pointer to matrix B.</li>
<li><code>float *c</code>: pointer to matrix C.</li>
</ul>
<h2 id="generic-executor">Generic executor</h2>
<h4 id="exec">Exec</h4>
<pre><code class="language-C">int vaccel_exec(struct vaccel_session *sess, const char *library,
                const char *fn_symbol, struct vaccel_arg *read,
                size_t nr_read, struct vaccel_arg *write, size_t nr_write);
</code></pre>
<ul>
<li><code>struct vaccel_session *sess</code>: a pointer to a vAccel session created using
  <code>vaccel_sess_init()</code>.</li>
<li><code>const char *library</code>: name of the shared object to open.</li>
<li><code>const char *fn_symbol</code>: name of the symbol to dereference in the shared object <code>library</code>.</li>
<li><code>struct vaccel_arg *read</code>: pointer to an array of <code>struct vaccel_arg</code> read-only arguments to <code>fn_symbol</code>.</li>
<li><code>size_t nr_read</code>: number of elements for the <code>read</code> array.</li>
<li><code>struct vaccel_arg *write</code>: pointer to an array of <code>struct vaccel_arg</code> write-only arguments to <code>fn_symbol</code>.</li>
<li><code>size_t nr_write</code>: number of elements for the <code>write</code> array.</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../usecases/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Use Cases
              </div>
            </div>
          </a>
        
        
          <a href="../plugin/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Add a plugin
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 - 2021 Nubificus LTD
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>